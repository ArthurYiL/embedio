<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="EmbedIO - A tiny, cross-platform, module based web server by unosquare">

    <link rel="stylesheet" href="//cdn.jsdelivr.net/fontawesome/4.3.0/css/font-awesome.min.css" />
    <link href="//maxcdn.bootstrapcdn.com/bootswatch/3.3.4/lumen/bootstrap.min.css" rel="stylesheet">
    <link href="//cdn.jsdelivr.net/highlight.js/8.5.0/styles/github.min.css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="images/stylesheet.css" media="screen">
    <script src="//cdn.jsdelivr.net/g/jquery@3.2.1,bootstrap@3.3.7"></script>
    <script src="//cdn.jsdelivr.net/highlight.js/8.5.0/highlight.min.js"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script>
    <link rel="icon" href="favicon.ico" />

    <title>EmbedIO - A tiny, cross-platform, module based web server by unosquare</title>
</head>

<body>
    <div id="wrapper">
        <div class="content-body">
            <div class="jumbotron-fade"></div>
            <div class="jumbotron">
                <div class="navbar-fade"></div>
                <header class="navbar navbar-static-top" id="top" role="banner">
                    <div class="container">
                        <div class="navbar-header">
                            <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
                                <i class="fa fa-bars"></i>
                            </button>
                        </div>
                        <nav class="collapse navbar-collapse bs-navbar-collapse">
                            <ul class="nav navbar-nav">
                                <li><a href="#features">Features</a></li>
                                <li><a href="#nuget">NuGet Installation</a></li>
                                <li class="dropdown">
                                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="true">
                                        Examples<span class="caret"></span>
                                    </a>
                                    <ul class="dropdown-menu" role="menu">
                                        <li><a href="#basic">Basic Example</a></li>
                                        <li><a href="#rest">REST API Example</a></li>
                                        <li><a href="#websocket">Web Sockets Example</a></li>
                                    </ul>
                                </li>
                                <li><a href="#cli">EmbedIO CLI</a></li>
                                <li><a href="api/Unosquare.Labs.EmbedIO.html">Documentation</a></li>
                                <li><a href="https://unosquare.github.io/embedio-extras/">Extras</a></li>
                            </ul>
                            <ul class="nav navbar-nav navbar-right">
                                <li><a href="http://github.com/unosquare/embedio">GitHub</a></li>
                                <li><a href="http://unosquare.github.io/">Unosquare Labs</a></li>
                            </ul>
                        </nav>
                    </div>
                </header>
                <div class="container">
                    <div class="row">
                        <div class="col-md-4 col-xs-12">
                            <div class="text-center">
                                <img src="images/embedio.png" alt="EmbedIO" />
                            </div>
                        </div>
                        <div class="col-md-8 col-xs-12">
                        </div>
                    </div>
                </div>
            </div>
            <div class="container">
                <p><strong>This README is for EmbedIO v2.x. Click <a href="https://github.com/unosquare/embedio/tree/v1.X">here</a> if you are using EmbedIO v1.x.</strong></p>
<ul>
<li><a href="#overview">Overview</a>
<ul>
<li><a href="#embedio-20---whats-new">EmbedIO 2.0 - What's new</a></li>
<li><a href="#some-usage-scenarios">Some usage scenarios</a></li>
</ul>
</li>
<li><a href="#installation">Installation</a></li>
<li><a href="#examples">Examples</a>
<ul>
<li><a href="#basic-example">Basic Example</a></li>
<li><a href="#fluent-example">Fluent Example</a></li>
<li><a href="#rest-api-example">REST API Example</a></li>
<li><a href="#websockets-example">WebSockets Example</a></li>
</ul>
</li>
<li><a href="#related-projects-and-nugets">Related Projects and Nugets</a></li>
</ul>
<h2><a id="user-content-overview" class="anchor" aria-hidden="true" name="#overview"></a>Overview</h2>
<p>A tiny, cross-platform, module based, MIT-licensed web server for .NET Framework and .NET Core.</p>
<ul>
<li>Written entirely in C#, using our helpful library <a href="https://github.com/unosquare/swan">SWAN</a></li>
<li>Network operations use the async/await pattern: Responses are handled asynchronously</li>
<li>Multiple implementations support: EmbedIO can use Microsoft <code>HttpListener</code> or internal Http Listener based on <a href="https://www.mono-project.com/" rel="nofollow">Mono</a>/<a href="https://github.com/sta/websocket-sharp/">websocket-sharp</a> projects</li>
<li>Cross-platform: tested on multiple OS and runtimes. From Windows .NET Framework to Linux MONO.</li>
<li>Extensible: Write your own modules -- For example, video streaming, UPnP, etc. Check out <a href="https://github.com/unosquare/embedio-extras">EmbedIO Extras</a> for additional modules</li>
<li>Small memory footprint</li>
<li>Create REST APIs quickly with the out-of-the-box Web API module</li>
<li>Serve static or embedded files with 1 line of code (also out-of-the-box)</li>
<li>Handle sessions with the built-in LocalSessionWebModule</li>
<li>WebSockets support</li>
<li>CORS support. Origin, Header and Method validation with OPTIONS preflight</li>
<li>Supports HTTP 206 Partial Content</li>
<li>And many more options in the same package</li>
</ul>
<p>Some notes regarding WebSocket and runtimes support:</p>
<table>
<thead>
<tr>
<th>Runtime</th>
<th>HTTP implementation</th>
<th>WebSocket support</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td>NET452</td>
<td><em>Unosquare</em> and Microsoft</td>
<td>Yes</td>
<td>Support Win7+ OS, Linux and macOS.</td>
</tr>
<tr>
<td>NET47</td>
<td>Unosquare and <em>Microsoft</em></td>
<td></td>
<td>Yes</td>
</tr>
<tr>
<td>NETSTANDARD13</td>
<td><em>Unosquare</em></td>
<td>Yes</td>
<td>Support Windows, Linux and macOS using native System.Net library</td>
</tr>
<tr>
<td>NETSTANDARD20</td>
<td>Unosquare and <em>Microsoft</em></td>
<td>Yes</td>
<td>Support Windows, Linux and macOS using native System.Net library</td>
</tr>
<tr>
<td>UAP</td>
<td><em>Unosquare</em></td>
<td>No</td>
<td>Support Windows Universal Platform. More information <a href="https://github.com/unosquare/embedio/tree/master/src/Unosquare.Labs.EmbedIO.IoT">here</a></td>
</tr></tbody></table>
<h3><a id="user-content-embedio-20---whats-new" class="anchor" aria-hidden="true" name="#embedio-20---whats-new"></a>EmbedIO 2.0 - What's new</h3>
<h4><a id="user-content-breaking-changes" class="anchor" aria-hidden="true" name="#breaking-changes"></a>Breaking changes</h4>
<ul>
<li><code>WebApiController</code> is renewed. Reduce the methods overhead removing the WebServer and Context arguments. See example belows.</li>
<li><code>RoutingStrategy.Regex</code> is the default routing scheme.</li>
</ul>
<h4><a id="user-content-additional-changes" class="anchor" aria-hidden="true" name="#additional-changes"></a>Additional changes</h4>
<ul>
<li><code>IHttpListener</code> is runtime/platform independent, you can choose Unosquare <code>HttpListener</code> implementation with NET47 or NETSTANDARD20. This separation of implementations brings new access to interfaces from common Http objects like <code>IHttpRequest</code>, <code>IHttpContext</code> and mor.</li>
<li><code>IWebServer</code> is a new interface to create custom web server implementation, like a Test Web Server where all the operations are in-memory to speed up unit testing. Similar to <a href="https://msdn.microsoft.com/en-us/library/microsoft.owin.testing.testserver(v=vs.113).aspx" rel="nofollow">TestServer from OWIN</a></li>
<li>General improvements in how the Unosquare <code>HttpListner</code> is working and code clean-up.</li>
</ul>
<p><em>Note</em> - We encourage to upgrade to the newest EmbedIO version. Branch version 1.X will no longer be maintained, and issues will be tested against 2.X and resolved just there.</p>
<h3><a id="user-content-some-usage-scenarios" class="anchor" aria-hidden="true" name="#some-usage-scenarios"></a>Some usage scenarios:</h3>
<ul>
<li>Write a cross-platform GUI entirely using React/AngularJS/Vue.js or any Javascript framework</li>
<li>Write a game using Babylon.js and make EmbedIO your serve your code and assets</li>
<li>Create GUIs for Windows services or Linux daemons</li>
<li>Works well with <a href="https://github.com/unosquare/litelib">LiteLib</a> - add SQLite support in minutes!</li>
<li>Write client applications with real-time communication between them using WebSockets</li>
<li>Write internal web server for Xamarin Forms applications</li>
</ul>
<h2><a id="user-content-installation" class="anchor" aria-hidden="true" name="#installation"></a>Installation:</h2>
<p>You can start using EmbedIO by just downloading the nuget.</p>
<h3><a id="user-content-package-manager" class="anchor" aria-hidden="true" name="#package-manager"></a>Package Manager</h3>
<pre><code>PM&gt; Install-Package EmbedIO
</code></pre>
<h3><a id="user-content-net-cli" class="anchor" aria-hidden="true" name="#net-cli"></a>.NET CLI</h3>
<pre><code>&gt; dotnet add package EmbedIO
</code></pre>
<h2><a id="user-content-examples" class="anchor" aria-hidden="true" name="#examples"></a>Examples</h2>
<h2><a id="user-content-basic-example" class="anchor" aria-hidden="true" name="#basic-example"></a>Basic Example:</h2>
<p>Please note the comments are the important part here. More info is available in the samples.</p>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">namespace</span> <span class="pl-en">Unosquare</span>
{
    <span class="pl-k">using</span> <span class="pl-en">System</span>;
    <span class="pl-k">using</span> <span class="pl-en">Unosquare</span>.<span class="pl-en">Labs</span>.<span class="pl-en">EmbedIO</span>;
    <span class="pl-k">using</span> <span class="pl-en">Unosquare</span>.<span class="pl-en">Labs</span>.<span class="pl-en">EmbedIO</span>.<span class="pl-en">Modules</span>;

    <span class="pl-k">class</span> <span class="pl-en">Program</span>
    {
        <span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;</span>
        <span class="pl-c"><span class="pl-c">///</span> Defines the entry point of the application.</span>
        <span class="pl-c"><span class="pl-c">///</span> &lt;/<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;</span>
        <span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">param</span></span> <span class="pl-e"><span class="pl-e">name</span></span>=<span class="pl-s"><span class="pl-pds">"</span>args<span class="pl-pds">"</span></span>&gt;The arguments.&lt;/<span class="pl-ent"><span class="pl-ent">param</span></span>&gt;</span>
        <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">Main</span>(<span class="pl-k">string</span>[] <span class="pl-smi">args</span>)
        {
            <span class="pl-k">var</span> <span class="pl-smi">url</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>http://localhost:9696/<span class="pl-pds">"</span></span>;
            <span class="pl-k">if</span> (<span class="pl-smi">args</span>.<span class="pl-smi">Length</span> <span class="pl-k">&gt;</span> <span class="pl-c1">0</span>)
                <span class="pl-smi">url</span> <span class="pl-k">=</span> <span class="pl-smi">args</span>[<span class="pl-c1">0</span>];

            <span class="pl-c"><span class="pl-c">//</span> Our web server is disposable.</span>
            <span class="pl-k">using</span> (<span class="pl-k">var</span> <span class="pl-smi">server</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">WebServer</span>(<span class="pl-smi">url</span>))
            {
                <span class="pl-c"><span class="pl-c">//</span> First, we will configure our web server by adding Modules.</span>
                <span class="pl-c"><span class="pl-c">//</span> Please note that order DOES matter.</span>
                <span class="pl-c"><span class="pl-c">//</span> ================================================================================================</span>
                <span class="pl-c"><span class="pl-c">//</span> If we want to enable sessions, we simply register the LocalSessionModule</span>
                <span class="pl-c"><span class="pl-c">//</span> Beware that this is an in-memory session storage mechanism so, avoid storing very large objects.</span>
                <span class="pl-c"><span class="pl-c">//</span> You can use the server.GetSession() method to get the SessionInfo object and manupulate it.</span>
                <span class="pl-c"><span class="pl-c">//</span> You could potentially implement a distributed session module using something like Redis</span>
                <span class="pl-smi">server</span>.<span class="pl-en">RegisterModule</span>(<span class="pl-k">new</span> <span class="pl-en">LocalSessionModule</span>());

                <span class="pl-c"><span class="pl-c">//</span> Here we setup serving of static files</span>
                <span class="pl-smi">server</span>.<span class="pl-en">RegisterModule</span>(<span class="pl-k">new</span> <span class="pl-en">StaticFilesModule</span>(<span class="pl-s"><span class="pl-pds">"</span>c:/web<span class="pl-pds">"</span></span>));
                <span class="pl-c"><span class="pl-c">//</span> The static files module will cache small files in ram until it detects they have been modified.</span>
                <span class="pl-smi">server</span>.<span class="pl-en">Module</span>&lt;<span class="pl-en">StaticFilesModule</span>&gt;().<span class="pl-smi">UseRamCache</span> <span class="pl-k">=</span> <span class="pl-c1">true</span>;
                <span class="pl-smi">server</span>.<span class="pl-en">Module</span>&lt;<span class="pl-en">StaticFilesModule</span>&gt;().<span class="pl-smi">DefaultExtension</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>.html<span class="pl-pds">"</span></span>;
                <span class="pl-c"><span class="pl-c">//</span> We don't need to add the line below. The default document is always index.html.</span>
                <span class="pl-c"><span class="pl-c">//</span>server.Module&lt;Modules.StaticFilesWebModule&gt;().DefaultDocument = "index.html";</span>

                <span class="pl-c"><span class="pl-c">//</span> Once we've registered our modules and configured them, we call the RunAsync() method.</span>
                <span class="pl-smi">server</span>.<span class="pl-en">RunAsync</span>();

                <span class="pl-c"><span class="pl-c">//</span> Fire up the browser to show the content if we are debugging!</span>
#<span class="pl-k">if</span> <span class="pl-en">DEBUG</span>
                <span class="pl-k">var</span> <span class="pl-smi">browser</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">System</span>.<span class="pl-k">Diagnostics</span>.<span class="pl-en">Process</span>()
                {
                    <span class="pl-smi">StartInfo</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">System</span>.<span class="pl-k">Diagnostics</span>.<span class="pl-en">ProcessStartInfo</span>(<span class="pl-smi">url</span>) { <span class="pl-smi">UseShellExecute</span> <span class="pl-k">=</span> <span class="pl-c1">true</span> }
                };
                <span class="pl-smi">browser</span>.<span class="pl-en">Start</span>();
#<span class="pl-k">endif</span>
                <span class="pl-c"><span class="pl-c">//</span> Wait for any key to be pressed before disposing of our web server.</span>
                <span class="pl-c"><span class="pl-c">//</span> In a service, we'd manage the lifecycle of our web server using</span>
                <span class="pl-c"><span class="pl-c">//</span> something like a BackgroundWorker or a ManualResetEvent.</span>
                <span class="pl-smi">Console</span>.<span class="pl-en">ReadKey</span>(<span class="pl-c1">true</span>);
            }
        }
    }
}</pre></div>
<h2><a id="user-content-fluent-example" class="anchor" aria-hidden="true" name="#fluent-example"></a>Fluent Example:</h2>
<p>Many extension methods are available. This allows you to create a web server instance in a fluent style by dotting in configuration options.</p>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">namespace</span> <span class="pl-en">Unosquare</span>
{
    <span class="pl-k">using</span> <span class="pl-en">System</span>;
    <span class="pl-k">using</span> <span class="pl-en">Unosquare</span>.<span class="pl-en">Labs</span>.<span class="pl-en">EmbedIO</span>;

    <span class="pl-k">internal</span> <span class="pl-k">class</span> <span class="pl-en">Program</span>
    {
        <span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;</span>
        <span class="pl-c"><span class="pl-c">///</span> Defines the entry point of the application.</span>
        <span class="pl-c"><span class="pl-c">///</span> &lt;/<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;</span>
        <span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">param</span></span> <span class="pl-e"><span class="pl-e">name</span></span>=<span class="pl-s"><span class="pl-pds">"</span>args<span class="pl-pds">"</span></span>&gt;The arguments.&lt;/<span class="pl-ent"><span class="pl-ent">param</span></span>&gt;</span>
        <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">Main</span>(<span class="pl-k">string</span>[] <span class="pl-smi">args</span>)
        {
            <span class="pl-k">var</span> <span class="pl-smi">url</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>http://localhost:9696/<span class="pl-pds">"</span></span>;
            <span class="pl-k">if</span> (<span class="pl-smi">args</span>.<span class="pl-smi">Length</span> <span class="pl-k">&gt;</span> <span class="pl-c1">0</span>)
                <span class="pl-smi">url</span> <span class="pl-k">=</span> <span class="pl-smi">args</span>[<span class="pl-c1">0</span>];

            <span class="pl-c"><span class="pl-c">//</span> Create Webserver and attach LocalSession and Static</span>
            <span class="pl-c"><span class="pl-c">//</span> files module and CORS enabled</span>
            <span class="pl-k">var</span> <span class="pl-smi">server</span> <span class="pl-k">=</span> <span class="pl-smi">WebServer</span>
                .<span class="pl-en">Create</span>(<span class="pl-smi">url</span>)
                .<span class="pl-en">EnableCors</span>()
                .<span class="pl-en">WithLocalSession</span>()
                .<span class="pl-en">WithStaticFolderAt</span>(<span class="pl-s"><span class="pl-pds">"</span>c:/web<span class="pl-pds">"</span></span>);

            <span class="pl-k">var</span> <span class="pl-smi">cts</span> <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-en">CancellationTokenSource</span>();
            <span class="pl-k">var</span> <span class="pl-smi">task</span> <span class="pl-k">=</span> <span class="pl-smi">server</span>.<span class="pl-en">RunAsync</span>(<span class="pl-smi">cts</span>.<span class="pl-smi">Token</span>);

            <span class="pl-smi">Console</span>.<span class="pl-en">ReadKey</span>(<span class="pl-c1">true</span>);
            <span class="pl-smi">cts</span>.<span class="pl-en">Cancel</span>();

			<span class="pl-c"><span class="pl-c">//</span> Wait before dispose server</span>
            <span class="pl-smi">task</span>.<span class="pl-en">Wait</span>();
            <span class="pl-smi">server</span>.<span class="pl-en">Dispose</span>();
        }
    }
}</pre></div>
<h2><a id="user-content-rest-api-example" class="anchor" aria-hidden="true" name="#rest-api-example"></a>REST API Example:</h2>
<p>The WebApi module supports two routing strategies: Wildcard and Regex. By default, the WebApi module will use the <strong>Regex Routing Strategy</strong> trying to match and resolve the values from a route template, in a similar fashion to Microsoft's Web API.</p>
<p>A method with the following route <code>/api/people/{id}</code> is going to match any request URL with three segments: the first two <code>api</code> and <code>people</code> and the last
one is going to be parsed or converted to the type in the <code>id</code> argument of the handling method signature. Please read on if this was confusing as it is
much simpler than it sounds. Additionally, you can put multiple values to match, for example <code>/api/people/{mainSkill}/{age}</code>, and receive the
parsed values from the URL straight into the arguments of your handler method.</p>
<p>During server setup:</p>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span> <span class="pl-smi">server</span> <span class="pl-k">=</span>  <span class="pl-k">new</span> <span class="pl-en">WebServer</span>(<span class="pl-s"><span class="pl-pds">"</span>http://localhost:9696/<span class="pl-pds">"</span></span>, <span class="pl-smi">RoutingStrategy</span>.<span class="pl-smi">Regex</span>);

<span class="pl-smi">server</span>.<span class="pl-en">RegisterModule</span>(<span class="pl-k">new</span> <span class="pl-en">WebApiModule</span>());
<span class="pl-smi">server</span>.<span class="pl-en">Module</span>&lt;<span class="pl-en">WebApiModule</span>&gt;().<span class="pl-en">RegisterController</span>&lt;<span class="pl-en">PeopleController</span>&gt;();</pre></div>
<p>And our controller class (using default Regex Strategy) looks like:</p>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">PeopleController</span> : <span class="pl-en">WebApiController</span>
{
    <span class="pl-k">public</span> <span class="pl-en">PeopleController</span>(<span class="pl-en">IHttpContext</span> <span class="pl-smi">context</span>)
    : <span class="pl-k">base</span>(<span class="pl-smi">context</span>)
    {
    }

    [<span class="pl-en">WebApiHandler</span>(<span class="pl-smi">HttpVerbs</span>.<span class="pl-smi">Get</span>, <span class="pl-s"><span class="pl-pds">"</span>/api/people/{id}<span class="pl-pds">"</span></span>)]
    <span class="pl-k">public</span> <span class="pl-k">bool</span> <span class="pl-en">GetPeople</span>(<span class="pl-k">int</span> <span class="pl-smi">id</span>)
    {
        <span class="pl-k">try</span>
        {
            <span class="pl-k">if</span> (<span class="pl-smi">People</span>.<span class="pl-en">Any</span>(<span class="pl-smi">p</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">p</span>.<span class="pl-smi">Key</span> <span class="pl-k">==</span> <span class="pl-smi">id</span>))
            {
                <span class="pl-k">return</span> <span class="pl-k">this</span>.<span class="pl-en">JsonResponse</span>(<span class="pl-smi">People</span>.<span class="pl-en">FirstOrDefault</span>(<span class="pl-smi">p</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">p</span>.<span class="pl-smi">Key</span> <span class="pl-k">==</span> <span class="pl-smi">id</span>));
            }
        }
        <span class="pl-k">catch</span> (<span class="pl-en">Exception</span> <span class="pl-smi">ex</span>)
        {
            <span class="pl-k">return</span> <span class="pl-k">this</span>.<span class="pl-en">JsonExceptionResponse</span>(<span class="pl-smi">ex</span>);
        }
    }
    
    <span class="pl-c"><span class="pl-c">//</span> You can override the default headers and add custom headers to each API Response.</span>
    <span class="pl-k">public</span> <span class="pl-k">override</span> <span class="pl-k">void</span> <span class="pl-en">SetDefaultHeaders</span>() <span class="pl-k">=&gt;</span> <span class="pl-k">this</span>.<span class="pl-en">NoCache</span>();
}</pre></div>
<p>The previous default strategy (Wildcard) matches routes using the asterisk <code>*</code> character in the route. <strong>For example:</strong></p>
<ul>
<li>The route <code>/api/people/*</code> will match any request with a URL starting with the two first URL segments <code>api</code> and
<code>people</code> and ending with anything. The route <code>/api/people/hello</code> will be matched.</li>
<li>You can also use wildcards in the middle of the route. The route <code>/api/people/*/details</code> will match requests
starting with the two first URL segments <code>api</code> and <code>people</code>, and end with a <code>details</code> segment. The route <code>/api/people/hello/details</code> will be matched.</li>
</ul>
<p>During server setup:</p>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">var</span> <span class="pl-smi">server</span> <span class="pl-k">=</span>  <span class="pl-k">new</span> <span class="pl-en">WebServer</span>(<span class="pl-s"><span class="pl-pds">"</span>http://localhost:9696/<span class="pl-pds">"</span></span>, <span class="pl-smi">RoutingStrategy</span>.<span class="pl-smi">Regex</span>);

<span class="pl-smi">server</span>.<span class="pl-en">RegisterModule</span>(<span class="pl-k">new</span> <span class="pl-en">WebApiModule</span>());
<span class="pl-smi">server</span>.<span class="pl-en">Module</span>&lt;<span class="pl-en">WebApiModule</span>&gt;().<span class="pl-en">RegisterController</span>&lt;<span class="pl-en">PeopleController</span>&gt;();</pre></div>
<div class="highlight highlight-source-cs"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">PeopleController</span> : <span class="pl-en">WebApiController</span>
{
    <span class="pl-k">public</span> <span class="pl-en">PeopleController</span>(<span class="pl-en">IHttpContext</span> <span class="pl-smi">context</span>)
    : <span class="pl-k">base</span>(<span class="pl-smi">context</span>)
    {
    }

    [<span class="pl-en">WebApiHandler</span>(<span class="pl-smi">HttpVerbs</span>.<span class="pl-smi">Get</span>, <span class="pl-s"><span class="pl-pds">"</span>/api/people/*<span class="pl-pds">"</span></span>)]
    <span class="pl-k">public</span> <span class="pl-k">bool</span> <span class="pl-en">GetPeople</span>()
    {
        <span class="pl-k">try</span>
        {
            <span class="pl-k">var</span> <span class="pl-smi">lastSegment</span> <span class="pl-k">=</span> <span class="pl-k">this</span>.<span class="pl-smi">Request</span>.<span class="pl-smi">Url</span>.<span class="pl-smi">Segments</span>.<span class="pl-en">Last</span>();
            <span class="pl-k">if</span> (<span class="pl-smi">lastSegment</span>.<span class="pl-en">EndsWith</span>(<span class="pl-s"><span class="pl-pds">"</span>/<span class="pl-pds">"</span></span>))
                <span class="pl-k">return</span> <span class="pl-k">this</span>.<span class="pl-en">JsonResponse</span>(<span class="pl-smi">People</span>);

            <span class="pl-k">int</span> <span class="pl-smi">key</span> <span class="pl-k">=</span> <span class="pl-c1">0</span>;
            <span class="pl-k">if</span> (<span class="pl-smi">int</span>.<span class="pl-en">TryParse</span>(<span class="pl-smi">lastSegment</span>, <span class="pl-k">out</span> <span class="pl-smi">key</span>) <span class="pl-k">&amp;&amp;</span> <span class="pl-smi">People</span>.<span class="pl-en">Any</span>(<span class="pl-smi">p</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">p</span>.<span class="pl-smi">Key</span> <span class="pl-k">==</span> <span class="pl-smi">key</span>))
            {
                <span class="pl-k">return</span> <span class="pl-k">this</span>.<span class="pl-en">JsonResponse</span>(<span class="pl-smi">People</span>.<span class="pl-en">FirstOrDefault</span>(<span class="pl-smi">p</span> <span class="pl-k">=&gt;</span> <span class="pl-smi">p</span>.<span class="pl-smi">Key</span> <span class="pl-k">==</span> <span class="pl-smi">key</span>));
            }

            <span class="pl-k">throw</span> <span class="pl-k">new</span> <span class="pl-en">KeyNotFoundException</span>(<span class="pl-s"><span class="pl-pds">"</span>Key Not Found: <span class="pl-pds">"</span></span> <span class="pl-k">+</span> <span class="pl-smi">lastSegment</span>);
        }
        <span class="pl-k">catch</span> (<span class="pl-en">Exception</span> <span class="pl-smi">ex</span>)
        {
            <span class="pl-k">return</span> <span class="pl-k">this</span>.<span class="pl-en">JsonExceptionResponse</span>(<span class="pl-smi">ex</span>);
        }
    }
}</pre></div>
<p>The <code>SetDefaultHeaders</code> method will add a no-cache policy to all Web API responses. If you plan to handle a differente policy or even custom headers to each different Web API method we recommend you override this method as you need.</p>
<h2><a id="user-content-websockets-example" class="anchor" aria-hidden="true" name="#websockets-example"></a>WebSockets Example:</h2>
<p><em>During server setup:</em></p>
<div class="highlight highlight-source-cs"><pre><span class="pl-smi">server</span>.<span class="pl-en">RegisterModule</span>(<span class="pl-k">new</span> <span class="pl-en">WebSocketsModule</span>());
<span class="pl-smi">server</span>.<span class="pl-en">Module</span>&lt;<span class="pl-en">WebSocketsModule</span>&gt;().<span class="pl-en">RegisterWebSocketsServer</span>&lt;<span class="pl-en">WebSocketsChatServer</span>&gt;(<span class="pl-s"><span class="pl-pds">"</span>/chat<span class="pl-pds">"</span></span>);</pre></div>
<p><em>And our web sockets server class looks like:</em></p>
<div class="highlight highlight-source-cs"><pre><span class="pl-c"><span class="pl-c">///</span> &lt;<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;</span>
<span class="pl-c"><span class="pl-c">///</span> Defines a very simple chat server</span>
<span class="pl-c"><span class="pl-c">///</span> &lt;/<span class="pl-ent"><span class="pl-ent">summary</span></span>&gt;</span>
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">WebSocketsChatServer</span> : <span class="pl-en">WebSocketsServer</span>
{
    <span class="pl-k">public</span> <span class="pl-en">WebSocketsChatServer</span>()
        : <span class="pl-k">base</span>(<span class="pl-c1">true</span>, <span class="pl-c1">0</span>)
    {
        <span class="pl-c"><span class="pl-c">//</span> placeholder</span>
    }

    <span class="pl-k">public</span> <span class="pl-k">override</span> <span class="pl-k">string</span> <span class="pl-smi">ServerName</span> <span class="pl-k">=&gt;</span> <span class="pl-s"><span class="pl-pds">"</span>Chat Server<span class="pl-pds">"</span></span>

    <span class="pl-smi">protected</span> <span class="pl-smi">override</span> <span class="pl-smi">void</span> <span class="pl-en">OnMessageReceived</span>(<span class="pl-en">WebSocketContext</span> <span class="pl-smi">context</span>, <span class="pl-k">byte</span>[] <span class="pl-smi">rxBuffer</span>, <span class="pl-en">WebSocketReceiveResult</span> <span class="pl-smi">rxResult</span>)
    {
        <span class="pl-smi">var</span> <span class="pl-smi">session</span> <span class="pl-k">=</span> <span class="pl-k">this</span>.<span class="pl-smi">WebServer</span>.<span class="pl-en">GetSession</span>(<span class="pl-smi">context</span>);
        <span class="pl-en">foreach</span> (<span class="pl-smi">var</span> <span class="pl-smi">ws</span> <span class="pl-smi">in</span> <span class="pl-k">this</span>.<span class="pl-smi">WebSockets</span>)
        {
            <span class="pl-en">if</span> (<span class="pl-smi">ws</span> <span class="pl-k">!=</span> <span class="pl-smi">context</span>)
                <span class="pl-k">this</span>.<span class="pl-en">Send</span>(<span class="pl-smi">ws</span>, <span class="pl-smi">rxBuffer</span>.<span class="pl-en">ToText</span>());
        }
    }

    <span class="pl-smi">protected</span> <span class="pl-smi">override</span> <span class="pl-smi">void</span> <span class="pl-en">OnClientConnected</span>(<span class="pl-en">WebSocketContext</span> <span class="pl-smi">context</span>)
    {
        <span class="pl-k">this</span>.<span class="pl-en">Send</span>(<span class="pl-smi">context</span>, <span class="pl-s"><span class="pl-pds">"</span>Welcome to the chat room!<span class="pl-pds">"</span></span>);
        
        <span class="pl-en">foreach</span> (<span class="pl-smi">var</span> <span class="pl-smi">ws</span> <span class="pl-smi">in</span> <span class="pl-k">this</span>.<span class="pl-smi">WebSockets</span>)
        {
            <span class="pl-en">if</span> (<span class="pl-smi">ws</span> <span class="pl-k">!=</span> <span class="pl-smi">context</span>)
                <span class="pl-k">this</span>.<span class="pl-en">Send</span>(<span class="pl-smi">ws</span>, <span class="pl-s"><span class="pl-pds">"</span>Someone joined the chat room.<span class="pl-pds">"</span></span>);
        }
    }

    <span class="pl-smi">protected</span> <span class="pl-smi">override</span> <span class="pl-smi">void</span> <span class="pl-en">OnFrameReceived</span>(<span class="pl-en">WebSocketContext</span> <span class="pl-smi">context</span>, <span class="pl-k">byte</span>[] <span class="pl-smi">rxBuffer</span>, <span class="pl-en">WebSocketReceiveResult</span> <span class="pl-smi">rxResult</span>)
    {
        <span class="pl-smi">return</span>;
    }

    <span class="pl-smi">protected</span> <span class="pl-smi">override</span> <span class="pl-smi">void</span> <span class="pl-en">OnClientDisconnected</span>(<span class="pl-en">WebSocketContext</span> <span class="pl-smi">context</span>)
    {
        <span class="pl-k">this</span>.<span class="pl-en">Broadcast</span>(<span class="pl-s"><span class="pl-pds">"</span>Someone left the chat room.<span class="pl-pds">"</span></span>);
    }
}</pre></div>
<h2><a id="user-content-related-projects-and-nugets" class="anchor" aria-hidden="true" name="#related-projects-and-nugets"></a>Related Projects and Nugets</h2>
<table>
<thead>
<tr>
<th>Name</th>
<th>Author</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.nuget.org/packages/Butterfly.EmbedIO/" rel="nofollow">Butterfly.EmbedIO</a></td>
<td>Fireshark Studios, LLC</td>
<td>Implementation of Butterfly.Core.Channel and Butterfly.Core.WebApi using the EmbedIO server</td>
</tr>
<tr>
<td><a href="https://github.com/unosquare/embedio-cli">embedio-cli</a></td>
<td>Unosquare</td>
<td>A dotnet global tool that enables start any web folder or EmbedIO assembly (WebAPI or WebSocket) from command line.</td>
</tr>
<tr>
<td><a href="https://www.nuget.org/packages/EmbedIO.BearerToken/" rel="nofollow">EmbedIO.BearerToken</a></td>
<td>Unosquare</td>
<td>Allow to authenticate with a Bearer Token. It uses a Token endpoint (at /token path) and with a defined validation delegate create a JsonWebToken. The module can check all incoming requests or a paths</td>
</tr>
<tr>
<td><a href="https://www.nuget.org/packages/EmbedIO.LiteLibWebApi/" rel="nofollow">EmbedIO.LiteLibWebApi</a></td>
<td>Unosquare</td>
<td>Allow to expose a sqlite database as REST api using EmbedIO WebApi and LiteLib libraries</td>
</tr>
<tr>
<td><a href="https://www.nuget.org/packages/EmbedIO.OWIN/" rel="nofollow">EmbedIO.OWIN</a></td>
<td>Unosquare</td>
<td>EmbedIO can use the OWIN platform in two different approach: You can use EmbedIO as OWIN server and use all OWIN framework with EmbedIO modules.</td>
</tr>
<tr>
<td><a href="https://www.nuget.org/packages/Microsoft.AspNetCore.Server.EmbedIO/" rel="nofollow">Microsoft.AspNetCore.Server.EmbedIO</a></td>
<td>Dju</td>
<td>EmbedIO web server support for ASP.NET Core, as a drop-in replacement for Kestrel</td>
</tr></tbody></table>
            </div>
            <footer>
                Brought to you by Unosquare<br />
                <a href="http://www.unosquare.com">
                    <img alt="unosquare" src="images/logo_178.png" />
                </a>
            </footer>
        </div>
    </div>
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-8535255-2', 'auto');
        ga('send', 'pageview');
    </script>
</body>

</html>
